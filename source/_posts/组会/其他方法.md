---
title: 其他漏洞挖掘方法
date: 2023-5-21 12:15:37
tags: 
    - 组会 
categories: 组会
toc: true
language: zh-CN
---

## 静态代码扫描
逻辑漏洞挖掘主要依靠手工代码审计来发现,也有一些工具可以辅助检测。常用的逻辑漏洞挖掘工具有:

1. Flawfinder - 源码安全审计工具,可以检测缓冲区溢出、格式字符串漏洞、SQL注入、命令执行等逻辑漏洞。
Flawfinder是一款开源的关于C/C++静态扫描分析工具，其根据内部字典数据库进行静态搜索，匹配简单的缺陷与漏洞，flawfinder工具不需要编译C/C++代码，可以直接进行扫描分析。简单快速，最大的有点就是免费，不需要编译。flawfinder工具可以在官网进行下载。

2. Checkmarx CxSAST - 支持多语言的源码静态分析工具,可以检测XSS、SQL注入、命令执行、目录遍历等各种语言的逻辑漏洞。
   1. 只能安装在windows上
3. Fortify SCA -  Enterprise级的源码安全审计工具,支持主流开发语言,可以检测XSS、SQL注入、加密漏洞等高危逻辑漏洞。
4. Splint - C语言源码检查工具,可以检测缓冲区溢出、格式字符串漏洞等C/C++逻辑漏洞。
5.  Its4youIDI Core - 商业源码安全审计工具,支持多种语言,可以检测XSS、SQL注入、加密漏洞等各种高危逻辑漏洞。
6.  RATS - 用于C/C++源码安全审计的工具,可以检测缓冲区溢出、整数漏洞、格式字符串漏洞等C逻辑漏洞。
7.  ITS4 - 商业源码安全审计工具,可以自动检测C/C++代码中的XSS、SQL注入、缓冲区溢出、格式字符串漏洞等逻辑漏洞。
8.  CodeSonar - GrammaTech出品的源代码安全审计工具,支持C、C++等语言,可以检测内存损坏、资源泄漏、格式字符串漏洞、整数溢出等逻辑漏洞。
9.  CodeScan - 乐鑫IoT出品的源代码安全审计工具,支持C/C++,可以检测资源泄漏、格式字符串漏洞、缓冲区溢出等逻辑漏洞,专注嵌入式系统安全。


## Flawfinder的使用

对bind最新源码进行扫描，得到输出，经过分析整理，得到

|函数|问题|建议|
|-|-|-|
|access|在对文件的访问和真正使用之间对文件权限进行修改|正确设置文件的权限，如setuid，直接打开文件|
|atoi|如果没有检查字符串，可能溢出|检查字符串|
|char[]|静态长度的数组可能导致越界|检查越界、保证最大可能长度不会超过数组长度|
|chmod chown|依赖文件路径，在调用前移动文件|使用`fchmod` `fchown`|
|chroot|在不同系统的具体实现不同，某些系统下需要在调用后立刻调用`chdir("/")`|调用后立刻调用`chdir("/")`|
|equal mismatch|误报，只是一个变量，被判断为c++的std::equal函数|-|
|fgetc getc|误报：检查是否有可能的buffer越界，代码这里实际上根本没有buffer||
|fopen open|攻击者可能创建软连接，使程序打开其他文件|-|
|fprintf printf snprintf vfprintf vprintf vsnprintf|攻击者可能改变格式化字符串|使用常量作为格式化字符串|
|fscanf scanf sscanf|%s所控制的长度不确定|使用其他输入函数，或保证%s输入的字符串足够小|
|getenv|环境变量被攻击者修改，修改后内容、长度都不确定|检查环境变量|
|getopt getopt_long|老版本的实现不会检查溢出|安装时检查其实现、限制输入长度|
|gets sprintf|可能越界|使用fgets snprintf|
|memcpy read strcat strcpy|越界|保证buffer足够大，使用对应限制长度的函数|
|random srand srandom|不够安全，没有nonce|使用更安全的方法|
|strlen strncpy|检查不以'\0'结尾的字符串||
|strncat strncpy|容易用错|使用strcat_s, strlcat, snprintf|
|tmpfile|某些老系统上不安全||
|usleep|与`SIGALRM`和其他timer相互影响|Use nanosleep(2) or setitimer(2) instead.|

- 有误报
- 只是针对个别函数给出建议，与实际情况不符
- 有些问题只针对部分老版本系统/实现


## 漏洞挖掘情况

### knot 
挖到2个，未分析

### named
依旧没结果
