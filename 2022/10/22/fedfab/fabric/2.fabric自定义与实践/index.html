<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>fabric-2.fabric自定义与实践 - Jingtianer</title><link rel="manifest" href="/home/manifest.json"><meta name="application-name" content="Jingtianer"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Jingtianer"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="手动搭建hyperledger fabric v2.x，其中第二个视频中，创建组织的锚节点文件已经被弃用 命令参考   计划配置一个4个节点的网络，三个节点模拟IOT设备，一个代表公司节点  主要工作 创建了一个拥有两个org的通道 自定义了一个网络，org1拥有三个节点，org2拥有1个节点 用go语言自定义了chaincode并编译 在网络上安装通道，执行链码  fabric环境变量 为了使"><meta property="og:type" content="blog"><meta property="og:title" content="fabric-2.fabric自定义与实践"><meta property="og:url" content="https://jingtianer.github.io/home/2022/10/22/fedfab/fabric/2.fabric%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%AE%9E%E8%B7%B5/"><meta property="og:site_name" content="Jingtianer"><meta property="og:description" content="手动搭建hyperledger fabric v2.x，其中第二个视频中，创建组织的锚节点文件已经被弃用 命令参考   计划配置一个4个节点的网络，三个节点模拟IOT设备，一个代表公司节点  主要工作 创建了一个拥有两个org的通道 自定义了一个网络，org1拥有三个节点，org2拥有1个节点 用go语言自定义了chaincode并编译 在网络上安装通道，执行链码  fabric环境变量 为了使"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://github.com/jingtianer/fabric_note/blob/main/systemOverview.png?raw=true"><meta property="article:published_time" content="2022-10-22T13:15:38.000Z"><meta property="article:modified_time" content="2025-04-15T02:37:55.612Z"><meta property="article:author" content="Meow Meow Liu"><meta property="article:tag" content="fedfab"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://github.com/jingtianer/fabric_note/blob/main/systemOverview.png?raw=true"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://jingtianer.github.io/home/2022/10/22/fedfab/fabric/2.fabric%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%AE%9E%E8%B7%B5/"},"headline":"fabric-2.fabric自定义与实践","image":[],"datePublished":"2022-10-22T13:15:38.000Z","dateModified":"2025-04-15T02:37:55.612Z","author":{"@type":"Person","name":"Meow Meow Liu"},"publisher":{"@type":"Organization","name":"Jingtianer","logo":{"@type":"ImageObject","url":{"text":"Meow!!"}}},"description":"手动搭建hyperledger fabric v2.x，其中第二个视频中，创建组织的锚节点文件已经被弃用 命令参考   计划配置一个4个节点的网络，三个节点模拟IOT设备，一个代表公司节点  主要工作 创建了一个拥有两个org的通道 自定义了一个网络，org1拥有三个节点，org2拥有1个节点 用go语言自定义了chaincode并编译 在网络上安装通道，执行链码  fabric环境变量 为了使"}</script><link rel="canonical" href="https://jingtianer.github.io/home/2022/10/22/fedfab/fabric/2.fabric%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%AE%9E%E8%B7%B5/"><link rel="alternate" href="/home/atom.xml" title="Jingtianer" type="application/atom+xml"><link rel="icon" href="/home/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/vs.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/home/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/home/">Meow!!</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/home/">主页</a><a class="navbar-item" href="/home/archives">归档</a><a class="navbar-item" href="/home/categories">分类</a><a class="navbar-item" href="/home/tags">标签</a><a class="navbar-item" href="/home/about">关于我</a><a class="navbar-item" href="/home/tags/gallery">相册</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-10-22T13:15:38.000Z" title="2022/10/22 21:15:38">2022-10-22</time>发表</span><span class="level-item"><time dateTime="2025-04-15T02:37:55.612Z" title="2025/4/15 10:37:55">2025-04-15</time>更新</span><span class="level-item"><a class="link-muted" href="/home/categories/fedfab/">fedfab</a></span><span class="level-item">29 分钟读完 (大约4371个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">fabric-2.fabric自定义与实践</h1><div class="content"><ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1EK411F7zM?share_source=copy_web&vd_source=c0998bdf37e0d8b17312f4b808c58394">手动搭建hyperledger fabric v2.x</a>，其中第二个视频中，创建组织的锚节点文件已经被弃用</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/command_ref.html">命令参考</a></li>
</ul>
<blockquote>
<p>计划配置一个4个节点的网络，三个节点模拟IOT设备，一个代表公司节点<br><img src="https://github.com/jingtianer/fabric_note/blob/main/systemOverview.png?raw=true"></p>
</blockquote>
<h2 id="主要工作"><a href="#主要工作" class="headerlink" title="主要工作"></a>主要工作</h2><ol>
<li>创建了一个拥有两个org的通道</li>
<li>自定义了一个网络，org1拥有三个节点，org2拥有1个节点</li>
<li>用go语言自定义了chaincode并编译</li>
<li>在网络上安装通道，执行链码</li>
</ol>
<h2 id="fabric环境变量"><a href="#fabric环境变量" class="headerlink" title="fabric环境变量"></a>fabric环境变量</h2><ul>
<li>为了使用cryptogen等工具<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> fabric-samples/bin</span><br><span class="line">sudo <span class="built_in">echo</span> <span class="built_in">export</span> PATH=\<span class="variable">$PATH</span>:$(<span class="built_in">pwd</span>) &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="创建节点目录，使用cryptogen命令"><a href="#创建节点目录，使用cryptogen命令" class="headerlink" title="创建节点目录，使用cryptogen命令"></a>创建节点目录，使用cryptogen命令</h2><p>cryptogen 有如下五个子命令:</p>
<ul>
<li>help</li>
<li>generate</li>
<li>showtemplate</li>
<li>extend</li>
<li>version</li>
</ul>
<h3 id="创建模板文件"><a href="#创建模板文件" class="headerlink" title="创建模板文件"></a>创建模板文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cryptogen showtemplate &gt; crypto-config.yaml</span><br></pre></td></tr></table></figure>
<h3 id="修改模板"><a href="#修改模板" class="headerlink" title="修改模板"></a>修改模板</h3><h4 id="排序节点"><a href="#排序节点" class="headerlink" title="排序节点"></a>排序节点</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">## &quot;OrdererOrgs&quot; - Definition of organizations managing orderer nodes</span></span><br><span class="line"><span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">OrdererOrgs:</span><br><span class="line">  <span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">  <span class="comment">## Orderer</span></span><br><span class="line">  <span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">  - Name: Orderer</span><br><span class="line">    Domain: fedfab.com</span><br><span class="line">    EnableNodeOUs: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">    <span class="comment">## &quot;Specs&quot; - See PeerOrgs below for complete description</span></span><br><span class="line">    <span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">    Specs:</span><br><span class="line">      - Hostname: orderer</span><br></pre></td></tr></table></figure>
<ul>
<li>EnableNodeOUs，即是否启用Organization Unit</li>
</ul>
<h4 id="peer节点（组织1）"><a href="#peer节点（组织1）" class="headerlink" title="peer节点（组织1）"></a>peer节点（组织1）</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PeerOrgs:</span><br><span class="line">  <span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">  <span class="comment">## Org1</span></span><br><span class="line">  <span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">  - Name: Org1</span><br><span class="line">    Domain: org1.fedfab.com</span><br><span class="line">    EnableNodeOUs: <span class="literal">false</span> <span class="comment">#这里改为true</span></span><br><span class="line">  Template:</span><br><span class="line">    Count: 1 <span class="comment">## 这里改为3.</span></span><br><span class="line">    <span class="comment">## Start: 5</span></span><br><span class="line">    <span class="comment">## Hostname: &#123;&#123;.Prefix&#125;&#125;&#123;&#123;.Index&#125;&#125; ## default</span></span><br><span class="line">    <span class="comment">## SANS:</span></span><br><span class="line">  <span class="comment">##   - &quot;&#123;&#123;.Hostname&#125;&#125;.alt.&#123;&#123;.Domain&#125;&#125;&quot;</span></span><br><span class="line">  Users:</span><br><span class="line">    Count: 1 <span class="comment">#这里也改为3</span></span><br></pre></td></tr></table></figure>

<ul>
<li>User指操纵终端的人，在终端操纵的人</li>
</ul>
<h4 id="peer节点（组织2）"><a href="#peer节点（组织2）" class="headerlink" title="peer节点（组织2）"></a>peer节点（组织2）</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#---------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">## Org2: See &quot;Org1&quot; for full specification</span></span><br><span class="line"><span class="comment">## ---------------------------------------------------------------------------</span></span><br><span class="line">- Name: Org2</span><br><span class="line">  Domain: org2.fedfab.com</span><br><span class="line">  EnableNodeOUs: <span class="literal">false</span> <span class="comment">#改成true</span></span><br><span class="line">  Template:</span><br><span class="line">    Count: 1</span><br><span class="line">  Users:</span><br><span class="line">    Count: 1</span><br></pre></td></tr></table></figure>

<h3 id="生成证书文件"><a href="#生成证书文件" class="headerlink" title="生成证书文件"></a>生成证书文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cryptogen generate --config=crypto-config.yaml</span><br></pre></td></tr></table></figure>
<ul>
<li>输出，并创建了证书文件<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org1.fedfab.com</span><br><span class="line">org2.fedfab.com</span><br></pre></td></tr></table></figure></li>
<li>进入一个组织查看<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tt@tt-HP:~/Desktop/fabric/my-network/nodes/crypto-config/peerOrganizations/org1.fedfab.com$ <span class="built_in">ls</span></span><br><span class="line">ca  msp  peers  tlsca  <span class="built_in">users</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="创建通道"><a href="#创建通道" class="headerlink" title="创建通道"></a>创建通道</h2><ul>
<li>编写configtx.yaml配置文件</li>
<li>使用configtxgen命令创建通道</li>
</ul>
<h3 id="configtxgen的使用"><a href="#configtxgen的使用" class="headerlink" title="configtxgen的使用"></a>configtxgen的使用</h3><ul>
<li>configtxgen 工具没有子命令，但是支持flag，通过设置flag可以完成不同的任务。<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Usage of configtxgen:</span><br><span class="line">  -asOrg string</span><br><span class="line">      以特定组织（按名称）执行配置生成，仅包括组织（可能）有权设置的写集中的值。</span><br><span class="line">  -channelCreateTxBaseProfile string</span><br><span class="line">      指定要视为排序系统通道当前状态的轮廓（profile），以允许在通道创建交易生成期间修改非应用程序参数。仅在与 “outputCreateChannelTX”  结合时有效。</span><br><span class="line">  -channelID string</span><br><span class="line">      配置交易中使用的通道 ID。</span><br><span class="line">  -configPath string</span><br><span class="line">      包含所用的配置的路径。（如果设置的话）</span><br><span class="line">  -inspectBlock string</span><br><span class="line">      打印指定路径的区块中包含的配置。</span><br><span class="line">  -inspectChannelCreateTx string</span><br><span class="line">      打印指定路径的交易中包含的配置。</span><br><span class="line">  -outputAnchorPeersUpdate string</span><br><span class="line">      创建一个更新锚节点的配置更新（仅在默认通道创建时有效，并仅用于第一次更新）。</span><br><span class="line">  -outputBlock string</span><br><span class="line">      写入创世区块的路径。（如果设置的话）</span><br><span class="line">  -outputCreateChannelTx string</span><br><span class="line">      写入通道创建交易的路径。（如果设置的话）</span><br><span class="line">  -printOrg string</span><br><span class="line">      以 JSON 方式打印组织的定义。（手动向通道中添加组织时很有用）</span><br><span class="line">  -profile string</span><br><span class="line">      configtx.yaml 中用于生成的轮廓。</span><br><span class="line">  -version</span><br><span class="line">      显示版本信息。</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="configtx-yaml的编写"><a href="#configtx-yaml的编写" class="headerlink" title="configtx.yaml的编写"></a>configtx.yaml的编写</h3><p>官方文档在<a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/zh_CN/release-2.2/create_channel/create_channel.html#the-configtx-yaml-file">创建新通道</a>中详细介绍了configtx.yaml的写法</p>
<p>这里我直接复制test-network中的配置文件并进行相应修改</p>
<h3 id="创建configtx文件夹"><a href="#创建configtx文件夹" class="headerlink" title="创建configtx文件夹"></a>创建configtx文件夹</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> configtx</span><br></pre></td></tr></table></figure>
<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><ul>
<li><p>修改msp文件地址<br>将配置文件中的<code>MSPDir</code>-msp地址修改为在<a href="#%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6">生成证书文件</a>步骤中生成的文件的目录</p>
</li>
<li><p>修改证书地址<br>将配置文件中的<code>ClientTLSCert</code>和<code>ServerTLSCert</code>修改为在<a href="#%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6">生成证书文件</a>步骤中生成的文件的目录</p>
</li>
<li><p>写入创世块的配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">TwoOrgsOrdererGenesis:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line">    <span class="attr">Orderer:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></span><br><span class="line">        <span class="attr">Organizations:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="meta">*OrdererOrg</span></span><br><span class="line">        <span class="attr">Capabilities:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererCapabilities</span></span><br><span class="line">    <span class="attr">Consortiums:</span></span><br><span class="line">        <span class="attr">SampleConsortium:</span></span><br><span class="line">            <span class="attr">Organizations:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="meta">*Org1</span></span><br><span class="line">                <span class="bullet">-</span> <span class="meta">*Org2</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>编写yaml文件时要注意缩进，否则将导致执行失败</p>
</blockquote>
</li>
<li><p>写入创建应用通道的配置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">TwoOrgsChannel:</span></span><br><span class="line">    <span class="attr">Consortium:</span> <span class="string">SampleConsortium</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line">    <span class="attr">Application:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationDefaults</span></span><br><span class="line">        <span class="attr">Organizations:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="meta">*Org1</span></span><br><span class="line">            <span class="bullet">-</span> <span class="meta">*Org2</span></span><br><span class="line">        <span class="attr">Capabilities:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="string">***ApplicationCapabilities**</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="创建环境变量"><a href="#创建环境变量" class="headerlink" title="创建环境变量"></a>创建环境变量</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> FABRIC_CFG_PATH=<span class="variable">$&#123;PWD&#125;</span>/configtx</span><br></pre></td></tr></table></figure>
<h3 id="创建创世块"><a href="#创建创世块" class="headerlink" title="创建创世块"></a>创建创世块</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configtxgen -profile TwoOrgsOrdererGenesis -channelID system-channel -outputBlock ./system-genesis-block/genesis.block</span><br></pre></td></tr></table></figure>
<p>得到输出</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2022-08-27 20:52:53.432 CST 0001 INFO [common.tools.configtxgen] main -&gt; Loading configuration</span><br><span class="line">2022-08-27 20:52:53.441 CST 0002 INFO [common.tools.configtxgen.localconfig] completeInitialization -&gt; orderer <span class="built_in">type</span>: etcdraft</span><br><span class="line">2022-08-27 20:52:53.441 CST 0003 INFO [common.tools.configtxgen.localconfig] completeInitialization -&gt; Orderer.EtcdRaft.Options <span class="built_in">unset</span>, setting to tick_interval:<span class="string">&quot;500ms&quot;</span> election_tick:10 heartbeat_tick:1 max_inflight_blocks:5 snapshot_interval_size:16777216 </span><br><span class="line">2022-08-27 20:52:53.441 CST 0004 INFO [common.tools.configtxgen.localconfig] Load -&gt; Loaded configuration: /home/tt/Desktop/fabric/my-network/nodes/configtx/configtx.yaml</span><br><span class="line">2022-08-27 20:52:53.443 CST 0005 INFO [common.tools.configtxgen] doOutputBlock -&gt; Generating genesis block</span><br><span class="line">2022-08-27 20:52:53.443 CST 0006 INFO [common.tools.configtxgen] doOutputBlock -&gt; Creating system channel genesis block</span><br><span class="line">2022-08-27 20:52:53.443 CST 0007 INFO [common.tools.configtxgen] doOutputBlock -&gt; Writing genesis block</span><br></pre></td></tr></table></figure>

<h3 id="创建应用通道"><a href="#创建应用通道" class="headerlink" title="创建应用通道"></a>创建应用通道</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/channel2.tx -channelID channel2</span><br><span class="line">configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors.tx -channelID channel2 -asOrg Org1MSP</span><br><span class="line">configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors.tx -channelID channel2 -asOrg Org2MSP</span><br></pre></td></tr></table></figure>

<p>得到输出</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2022-08-27 21:01:01.223 CST 0001 INFO [common.tools.configtxgen] main -&gt; Loading configuration</span><br><span class="line">2022-08-27 21:01:01.233 CST 0002 INFO [common.tools.configtxgen.localconfig] Load -&gt; Loaded configuration: /home/tt/Desktop/fabric/my-network/nodes/configtx/configtx.yaml</span><br><span class="line">2022-08-27 21:01:01.233 CST 0003 INFO [common.tools.configtxgen] doOutputChannelCreateTx -&gt; Generating new channel configtx</span><br><span class="line">2022-08-27 21:01:01.235 CST 0004 INFO [common.tools.configtxgen] doOutputChannelCreateTx -&gt; Writing new channel tx</span><br></pre></td></tr></table></figure>

<h2 id="创建peer节点和order节点"><a href="#创建peer节点和order节点" class="headerlink" title="创建peer节点和order节点"></a>创建peer节点和order节点</h2><ul>
<li>使用docker compose对节点容器进行定义</li>
<li>在test-network的基础上进行修改</li>
</ul>
<h3 id="修改order节点"><a href="#修改order节点" class="headerlink" title="修改order节点"></a>修改order节点</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">orderer.fedfab.com:</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">orderer.fedfab.com</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">hyperledger/fabric-orderer:latest</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">service:</span> <span class="string">hyperledger-fabric</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_LISTENPORT=7050</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_LOCALMSPID=OrdererMSP</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</span></span><br><span class="line">    <span class="comment">## enabled TLS</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_ENABLED=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_CLUSTER_CLIENTCERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_CLUSTER_CLIENTPRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_CLUSTER_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line">    <span class="comment">## - ORDERER_GENERAL_BOOTSTRAPMETHOD=none #去掉</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_GENESISMETHOD=file</span> <span class="comment">#增加</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/system-genesis-block/genesis.block</span> <span class="comment">#增加</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_CHANNELPARTICIPATION_ENABLED=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_ADMIN_TLS_ENABLED=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_ADMIN_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_ADMIN_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_ADMIN_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_ADMIN_TLS_CLIENTROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_ADMIN_LISTENADDRESS=0.0.0.0:7053</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_OPERATIONS_LISTENADDRESS=orderer.fedfab.com:9443</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ORDERER_METRICS_PROVIDER=prometheus</span></span><br><span class="line">  <span class="attr">working_dir:</span> <span class="string">/root</span></span><br><span class="line">  <span class="attr">command:</span> <span class="string">orderer</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../crypto-config/ordererOrganizations/fedfab.com/orderers/orderer.fedfab.com/msp:/var/hyperledger/orderer/msp</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../crypto-config/ordererOrganizations/fedfab.com/orderers/orderer.fedfab.com/tls/:/var/hyperledger/orderer/tls</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../system-genesis-block/:/var/hyperledger/orderer/system-genesis-block</span> <span class="comment">#增加</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">orderer.fedfab.com:/var/hyperledger/production/orderer</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">7050</span><span class="string">:7050</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">7053</span><span class="string">:7053</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">9443</span><span class="string">:9443</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">test</span></span><br></pre></td></tr></table></figure>
<ul>
<li>后续会手动生成创世块，需要在compose中指定生成的创世块</li>
</ul>
<h3 id="增加节点个数"><a href="#增加节点个数" class="headerlink" title="增加节点个数"></a>增加节点个数</h3><ul>
<li>test-network中只有三个节点（排序和两个peer节点），现在修改为1排序+3org1+1org2</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">orderer.fedfab.com:</span></span><br><span class="line">  <span class="attr">peer0.org1.fedfab.com:</span></span><br><span class="line">  <span class="attr">peer1.org1.fedfab.com:</span></span><br><span class="line">  <span class="attr">peer2.org1.fedfab.com:</span></span><br><span class="line">  <span class="attr">peer0.org2.fedfab.com:</span></span><br></pre></td></tr></table></figure>
<ul>
<li>增加org1中的节点配置，以下面的配置文件为模板<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">peer0.org1.fedfab.com:</span> <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">peer0.org1.fedfab.com</span> <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">hyperledger/fabric-peer:latest</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">service:</span> <span class="string">hyperledger-fabric</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">FABRIC_CFG_PATH=/etc/hyperledger/peercfg</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></span><br><span class="line">    <span class="comment">#- FABRIC_LOGGING_SPEC=DEBUG</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_ENABLED=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_PROFILE_ENABLED=false</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</span></span><br><span class="line">    <span class="comment">## Peer specific variables</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_ID=peer0.org1.fedfab.com</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_ADDRESS=peer0.org1.fedfab.com:7051</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_LISTENADDRESS=0.0.0.0:7051</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_CHAINCODEADDRESS=peer0.org1.fedfab.com:7052</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_GOSSIP_BOOTSTRAP=peer0.org1.fedfab.com:7051</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.fedfab.com:7051</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_LOCALMSPID=Org1MSP</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/fabric/msp</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_OPERATIONS_LISTENADDRESS=peer0.org1.fedfab.com:9444</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_METRICS_PROVIDER=prometheus</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CHAINCODE_AS_A_SERVICE_BUILDER_CONFIG=&#123;&quot;peername&quot;:&quot;peer0org1&quot;&#125;</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_CHAINCODE_EXECUTETIMEOUT=300s</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../organizations/peerOrganizations/org1.fedfab.com/peers/peer0.org1.fedfab.com:/etc/hyperledger/fabric</span> <span class="comment">#修改</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">peer0.org1.fedfab.com:/var/hyperledger/production</span> <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">working_dir:</span> <span class="string">/root</span></span><br><span class="line">  <span class="attr">command:</span> <span class="string">peer</span> <span class="string">node</span> <span class="string">start</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">7051</span><span class="string">:7051</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">9444</span><span class="string">:9444</span> <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">test</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="修改容器的文件夹映射"><a href="#修改容器的文件夹映射" class="headerlink" title="修改容器的文件夹映射"></a>修改容器的文件夹映射</h3><ul>
<li>将tls，mse等路径，域名名称修改正确</li>
</ul>
<h3 id="修改端口号"><a href="#修改端口号" class="headerlink" title="修改端口号"></a>修改端口号</h3><table>
<thead>
<tr>
<th>编号</th>
<th>端口配置</th>
</tr>
</thead>
<tbody><tr>
<td>orderer.fedfab.com</td>
<td>7050:7050, 7053:7053, 9443:9443</td>
</tr>
<tr>
<td>peer0.org1.fedfab.com</td>
<td>8051:7051, 9444:9444</td>
</tr>
<tr>
<td>peer1.org1.fedfab.com</td>
<td>8052:7051, 9445:9444</td>
</tr>
<tr>
<td>peer2.org1.fedfab.com</td>
<td>8053:7051, 9446:9444</td>
</tr>
<tr>
<td>peer0.org2.fedfab.com</td>
<td>9051:7051, 9447:9444</td>
</tr>
</tbody></table>
<h3 id="CLI（命令行接口）配置"><a href="#CLI（命令行接口）配置" class="headerlink" title="CLI（命令行接口）配置"></a>CLI（命令行接口）配置</h3><ul>
<li>为每个节点创建一个cli</li>
<li>参考官方的cli配置教程，cli需要以下环境变量<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> FABRIC_CFG_PATH=<span class="variable">$PWD</span>/../config/</span><br><span class="line"><span class="built_in">export</span> CORE_PEER_TLS_ENABLED=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_LOCALMSPID=<span class="string">&quot;Org1MSP&quot;</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_TLS_ROOTCERT_FILE=<span class="variable">$&#123;PWD&#125;</span>/organizations/peerOrganizations/org1.fedfab.com/peers/peer0.org1.fedfab.com/tls/ca.crt</span><br><span class="line"><span class="built_in">export</span> CORE_PEER_MSPCONFIGPATH=<span class="variable">$&#123;PWD&#125;</span>/organizations/peerOrganizations/org1.fedfab.com/users/Admin@org1.fedfab.com/msp</span><br><span class="line"><span class="built_in">export</span> CORE_PEER_ADDRESS=localhost:7051</span><br></pre></td></tr></table></figure></li>
<li>根据上述环境变量和test-network中的cli配置，编写四个节点的cli<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cli1:</span> <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">cli1</span> <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">hyperledger/fabric-tools:latest</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">service:</span> <span class="string">hyperledger-fabric</span></span><br><span class="line">  <span class="attr">tty:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">stdin_open:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">GOPATH=/opt/gopath</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">FABRIC_CFG_PATH=/etc/hyperledger/peercfg</span></span><br><span class="line">    <span class="comment">#- FABRIC_LOGGING_SPEC=DEBUG</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_ID=cli1</span> <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_ENABLED=true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_LOCALMSPID=Org1MSP</span>  <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.fedfab.com/peers/peer0.org1.fedfab.com/tls/server.crt</span>  <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.fedfab.com/peers/peer0.org1.fedfab.com/tls/server.key</span>  <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.fedfab.com/peers/peer0.org1.fedfab.com/tls/ca.crt</span>  <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.fedfab.com/users/Admin@org1.fedfab.com/msp</span>  <span class="comment">#修改</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">CORE_PEER_ADDRESS=peer0.org1.fedfab.com:8051</span>  <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">working_dir:</span> <span class="string">/opt/gopath/src/github.com/hyperledger/fabric/peer</span></span><br><span class="line">  <span class="attr">command:</span> <span class="string">/bin/bash</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../crypto-config:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../scripts:/opt/gopath/src/github.com/hyperledger/fabric/peer/scripts/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/run/:/host/var/run/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../chaincode/go/:/opt/gopath/src/github.com/hyperledger/fabric-cluster/chaincode/go</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">../channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./docker/peercfg:/etc/hyperledger/peercfg</span></span><br><span class="line">  <span class="attr">depends_on:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">peer0.org1.fedfab.com</span>  <span class="comment">#修改</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">test</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>
<p>得到输出</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Creating network <span class="string">&quot;fabric_test&quot;</span> with the default driver</span><br><span class="line">Creating volume <span class="string">&quot;compose_orderer.fedfab.com&quot;</span> with default driver</span><br><span class="line">Creating volume <span class="string">&quot;compose_peer0.org1.fedfab.com&quot;</span> with default driver</span><br><span class="line">Creating volume <span class="string">&quot;compose_peer1.org1.fedfab.com&quot;</span> with default driver</span><br><span class="line">Creating volume <span class="string">&quot;compose_peer2.org1.fedfab.com&quot;</span> with default driver</span><br><span class="line">Creating volume <span class="string">&quot;compose_peer0.org2.fedfab.com&quot;</span> with default driver</span><br><span class="line">Creating peer0.org1.fedfab.com ... <span class="keyword">done</span></span><br><span class="line">Creating peer0.org2.fedfab.com ... <span class="keyword">done</span></span><br><span class="line">Creating peer1.org1.fedfab.com ... <span class="keyword">done</span></span><br><span class="line">Creating peer2.org1.fedfab.com ... <span class="keyword">done</span></span><br><span class="line">Creating orderer.fedfab.com    ... <span class="keyword">done</span></span><br><span class="line">Creating cli0                   ... <span class="keyword">done</span></span><br><span class="line">Creating cli3                   ... <span class="keyword">done</span></span><br><span class="line">Creating cli1                   ... <span class="keyword">done</span></span><br><span class="line">Creating cli2                   ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h3 id="验证容器是否启动"><a href="#验证容器是否启动" class="headerlink" title="验证容器是否启动"></a>验证容器是否启动</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID   IMAGE                               COMMAND             CREATED         STATUS                     PORTS                                                                                                                             NAMES</span><br><span class="line">d6a76f883fff   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         3 seconds ago   Up 2 seconds                                                                                                                                                 cli3</span><br><span class="line">77b3a4f45dd7   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         3 seconds ago   Up 2 seconds                                                                                                                                                 cli1</span><br><span class="line">cc967bbbffbc   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         3 seconds ago   Up 2 seconds                                                                                                                                                 cli2</span><br><span class="line">4cac839a509e   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         4 seconds ago   Up 2 seconds                                                                                                                                                 cli0</span><br><span class="line">dd8fb44841ed   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   4 seconds ago   Exited (1) 2 seconds ago                                                                                                                                     peer1.org1.fedfab.com</span><br><span class="line">37d044dc815b   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   4 seconds ago   Exited (1) 3 seconds ago                                                                                                                                     peer2.org1.fedfab.com</span><br><span class="line">c5d9572fd1b0   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   4 seconds ago   Exited (1) 2 seconds ago                                                                                                                                     peer0.org2.fedfab.com</span><br><span class="line">fa43da3532d7   hyperledger/fabric-orderer:latest   <span class="string">&quot;orderer&quot;</span>           4 seconds ago   Up 3 seconds               0.0.0.0:7050-&gt;7050/tcp, :::7050-&gt;7050/tcp, 0.0.0.0:7053-&gt;7053/tcp, :::7053-&gt;7053/tcp, 0.0.0.0:9443-&gt;9443/tcp, :::9443-&gt;9443/tcp   orderer.fedfab.com</span><br><span class="line">45b71846f669   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   4 seconds ago   Exited (1) 3 seconds ago                                                                                                                                     peer0.org1.fedfab.com</span><br></pre></td></tr></table></figure>

<ul>
<li><p>使用logs命令查看日志</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker logs peer0.org1.fedfab.com</span><br><span class="line">2022-08-28 11:18:05.811 UTC 0001 ERRO [main] InitCmd -&gt; Fatal error when initializing core config : FABRIC_CFG_PATH /etc/hyperledger/peercfg does not exist</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据<a target="_blank" rel="noopener" href="https://hub.docker.com/r/hyperledger/fabric-peer">docker hub - fabric-peer</a>的描述，在<code>FABRIC_CFG_PATH</code>下需要有core.yaml文件</p>
</li>
<li><p>复制一份test-network的core.yaml到compose文件夹下</p>
</li>
<li><p>在peer节点中添加映射</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">./docker/peercfg:/etc/hyperledger/peercfg</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>再次尝试创建容器，并使用ps命令验证</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID   IMAGE                               COMMAND             CREATED         STATUS         PORTS                                                                                                                             NAMES</span><br><span class="line">eaa7a6ad0dc4   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         4 seconds ago   Up 3 seconds                                                                                                                                     cli3</span><br><span class="line">6cfcf59846eb   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         5 seconds ago   Up 3 seconds                                                                                                                                     cli2</span><br><span class="line">29fe65400204   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         5 seconds ago   Up 3 seconds                                                                                                                                     cli1</span><br><span class="line">4ac9037d3c2c   hyperledger/fabric-tools:latest     <span class="string">&quot;/bin/bash&quot;</span>         5 seconds ago   Up 4 seconds                                                                                                                                     cli0</span><br><span class="line">a5e90a5b170a   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   5 seconds ago   Up 4 seconds   7051/tcp, 0.0.0.0:9051-&gt;9051/tcp, :::9051-&gt;9051/tcp, 0.0.0.0:9447-&gt;9445/tcp, :::9447-&gt;9445/tcp                                    peer0.org2.fedfab.com</span><br><span class="line">9b3b0f6445d2   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   5 seconds ago   Up 4 seconds   0.0.0.0:9444-&gt;9444/tcp, :::9444-&gt;9444/tcp, 0.0.0.0:8051-&gt;7051/tcp, :::8051-&gt;7051/tcp                                              peer0.org1.fedfab.com</span><br><span class="line">5d75a82337c8   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   5 seconds ago   Up 4 seconds   0.0.0.0:8052-&gt;7051/tcp, :::8052-&gt;7051/tcp, 0.0.0.0:9445-&gt;9444/tcp, :::9445-&gt;9444/tcp                                              peer1.org1.fedfab.com</span><br><span class="line">5eb7a92eb4e0   hyperledger/fabric-orderer:latest   <span class="string">&quot;orderer&quot;</span>           5 seconds ago   Up 4 seconds   0.0.0.0:7050-&gt;7050/tcp, :::7050-&gt;7050/tcp, 0.0.0.0:7053-&gt;7053/tcp, :::7053-&gt;7053/tcp, 0.0.0.0:9443-&gt;9443/tcp, :::9443-&gt;9443/tcp   orderer.fedfab.com</span><br><span class="line">17c6798b2dc9   hyperledger/fabric-peer:latest      <span class="string">&quot;peer node start&quot;</span>   5 seconds ago   Up 4 seconds   0.0.0.0:8053-&gt;7051/tcp, :::8053-&gt;7051/tcp, 0.0.0.0:9446-&gt;9444/tcp, :::9446-&gt;9444/tcp                                              peer2.org1.fedfab.com</span><br></pre></td></tr></table></figure>

<ul>
<li>全部容器都已经启动成功！</li>
</ul>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><ul>
<li>在test-network的network.sh脚本中仔细观察docker-compose的代码发现，test-network中使用了多个yml文件进行配置</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">networkUp</span></span>() &#123;</span><br><span class="line">  checkPrereqs</span><br><span class="line"></span><br><span class="line">  <span class="comment">## generate artifacts if they don&#x27;t exist</span></span><br><span class="line">  <span class="keyword">if</span> [ ! -d <span class="string">&quot;organizations/peerOrganizations&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    createOrgs</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  COMPOSE_FILES=<span class="string">&quot;-f compose/<span class="variable">$&#123;COMPOSE_FILE_BASE&#125;</span> -f compose/<span class="variable">$&#123;CONTAINER_CLI&#125;</span>/<span class="variable">$&#123;CONTAINER_CLI&#125;</span>-<span class="variable">$&#123;COMPOSE_FILE_BASE&#125;</span>&quot;</span> <span class="comment">#此处</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$&#123;DATABASE&#125;</span>&quot;</span> == <span class="string">&quot;couchdb&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    COMPOSE_FILES=<span class="string">&quot;<span class="variable">$&#123;COMPOSE_FILES&#125;</span> -f compose/<span class="variable">$&#123;COMPOSE_FILE_COUCH&#125;</span> -f compose/<span class="variable">$&#123;CONTAINER_CLI&#125;</span>/<span class="variable">$&#123;CONTAINER_CLI&#125;</span>-<span class="variable">$&#123;COMPOSE_FILE_COUCH&#125;</span>&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  DOCKER_SOCK=<span class="string">&quot;<span class="variable">$&#123;DOCKER_SOCK&#125;</span>&quot;</span> <span class="variable">$&#123;CONTAINER_CLI_COMPOSE&#125;</span> <span class="variable">$&#123;COMPOSE_FILES&#125;</span> up -d 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">  <span class="variable">$CONTAINER_CLI</span> ps -a</span><br><span class="line">  <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">    fatalln <span class="string">&quot;Unable to start network&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>故找到相应文件，将其中的配置添加到节点中（这也就是之前peer节点创建后启动失败的原因）</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.7&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">peer0.org1.fedfab.com:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">peer0.org1.fedfab.com</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">hyperledger/fabric-peer:latest</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">service:</span> <span class="string">hyperledger-fabric</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment">#Generic peer variables</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=fabric_test</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./docker/peercfg:/etc/hyperledger/peercfg</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">$&#123;DOCKER_SOCK&#125;:/host/var/run/docker.sock</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">peer0.org2.fedfab.com:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">peer0.org2.fedfab.com</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">hyperledger/fabric-peer:latest</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">service:</span> <span class="string">hyperledger-fabric</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment">#Generic peer variables</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=fabric_test</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./docker/peercfg:/etc/hyperledger/peercfg</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">$&#123;DOCKER_SOCK&#125;:/host/var/run/docker.sock</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">cli:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">cli</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">hyperledger/fabric-tools:latest</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./docker/peercfg:/etc/hyperledger/peercfg</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用docer-compose命令创建容器(添加DOCKER_SOCK)环境变量<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SOCK=<span class="string">&quot;<span class="variable">$&#123;DOCKER_HOST:-/var/run/docker.sock&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">export</span> DOCKER_SOCK=<span class="string">&quot;<span class="variable">$&#123;SOCK##unix://&#125;</span>&quot;</span></span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>docker容器建立了，但是docker-compose的配置文件中的很多细节并不清楚</p>
</blockquote>
<h2 id="修改host文件"><a href="#修改host文件" class="headerlink" title="修改host文件"></a>修改host文件</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">tee</span> -a /etc/hosts &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">127.0.0.1 orderer.fedfab.com</span><br><span class="line">127.0.0.1 peer0.org1.fedfab.com</span><br><span class="line">127.0.0.1 peer1.org1.fedfab.com</span><br><span class="line">127.0.0.1 peer2.org1.fedfab.com</span><br><span class="line">127.0.0.1 peer0.org2.fedfab.com</span><br><span class="line">EOF</span><br><span class="line"><span class="built_in">cat</span> /etc/hosts</span><br></pre></td></tr></table></figure>

<h2 id="安装链码"><a href="#安装链码" class="headerlink" title="安装链码"></a>安装链码</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/hyperledger/fabric-contract-api-go/blob/main/tutorials/getting-started.md">参考</a></li>
</ul>
<h3 id="Housekeeping"><a href="#Housekeeping" class="headerlink" title="Housekeeping"></a>Housekeeping</h3><p>初始化mod，获取fabric模块</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go mod init github.com/hyperledger/fabric-samples/chaincode/mycontract</span><br><span class="line">go get -u github.com/hyperledger/fabric-contract-api-go</span><br></pre></td></tr></table></figure>

<h3 id="编写链码，编译"><a href="#编写链码，编译" class="headerlink" title="编写链码，编译"></a>编写链码，编译</h3><p>编写好chaincode.go，下载依赖包，编译</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go mod vendor</span><br><span class="line">go build</span><br></pre></td></tr></table></figure>

<h3 id="配置通道"><a href="#配置通道" class="headerlink" title="配置通道"></a>配置通道</h3><ul>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/zh_CN/latest/commands/peercommand.html">peer命令介绍</a></li>
</ul>
<h4 id="进入cli容器"><a href="#进入cli容器" class="headerlink" title="进入cli容器"></a>进入cli容器</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it cli0 sh</span><br><span class="line">docker <span class="built_in">exec</span> -it cli1 sh</span><br><span class="line">docker <span class="built_in">exec</span> -it cli2 sh</span><br><span class="line">docker <span class="built_in">exec</span> -it cli3 sh</span><br></pre></td></tr></table></figure>
<h4 id="安装通道"><a href="#安装通道" class="headerlink" title="安装通道"></a>安装通道</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer channel create -o orderer.fedfab.com:7050 -c channel2 -f ./channel-artifacts/channel2.tx --tls <span class="literal">true</span> --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/fedfab.com/msp/tlscacerts/tlsca.fedfab.com-cert.pem</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">2022-08-29 08:31:23.202 UTC 0001 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:23.211 UTC 0002 INFO [cli.common] readBlock -&gt; Expect block, but got status: &amp;&#123;NOT_FOUND&#125;</span><br><span class="line">2022-08-29 08:31:23.214 UTC 0003 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:23.415 UTC 0004 INFO [cli.common] readBlock -&gt; Expect block, but got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2022-08-29 08:31:23.417 UTC 0005 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:23.619 UTC 0006 INFO [cli.common] readBlock -&gt; Expect block, but got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2022-08-29 08:31:23.621 UTC 0007 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:23.822 UTC 0008 INFO [cli.common] readBlock -&gt; Expect block, but got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2022-08-29 08:31:23.824 UTC 0009 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:24.026 UTC 000a INFO [cli.common] readBlock -&gt; Expect block, but got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2022-08-29 08:31:24.028 UTC 000b INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:24.229 UTC 000c INFO [cli.common] readBlock -&gt; Expect block, but got status: &amp;&#123;SERVICE_UNAVAILABLE&#125;</span><br><span class="line">2022-08-29 08:31:24.231 UTC 000d INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:31:24.434 UTC 000e INFO [cli.common] readBlock -&gt; Received block: 0</span><br></pre></td></tr></table></figure>

<h4 id="将生成的channel2-block复制到其他cli中"><a href="#将生成的channel2-block复制到其他cli中" class="headerlink" title="将生成的channel2.block复制到其他cli中"></a>将生成的channel2.block复制到其他cli中</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> cli0:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel2.block ./</span><br><span class="line">docker <span class="built_in">cp</span> ./channel2.block cli1:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel2.block</span><br><span class="line">docker <span class="built_in">cp</span> ./channel2.block cli2:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel2.block</span><br><span class="line">docker <span class="built_in">cp</span> ./channel2.block cli3:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel2.block</span><br></pre></td></tr></table></figure>

<h4 id="加入channel"><a href="#加入channel" class="headerlink" title="加入channel"></a>加入channel</h4><p>分别进入四个cli，执行以下命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer channel <span class="built_in">join</span> -b ./channel2.block</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2022-08-29 08:55:24.659 UTC 0001 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 08:55:24.695 UTC 0002 INFO [channelCmd] executeJoin -&gt; Successfully submitted proposal to <span class="built_in">join</span> channel</span><br></pre></td></tr></table></figure>

<ul>
<li>第一次执行时，cli0-cli2出现了connection refuse的情况，对docker compose文件进行修改，重新进行端口映射，则正常。这里出现这个问题的原因不详，容器内的端口号必须和外面匹配才行</li>
</ul>
<table>
<thead>
<tr>
<th>编号</th>
<th>端口配置</th>
</tr>
</thead>
<tbody><tr>
<td>orderer.fedfab.com</td>
<td>7050:7050, 7053:7053, 9443:9443</td>
</tr>
<tr>
<td>peer0.org1.fedfab.com</td>
<td>8051:8051, 9444:9444</td>
</tr>
<tr>
<td>peer1.org1.fedfab.com</td>
<td>8053:8053, 9445:9444</td>
</tr>
<tr>
<td>peer2.org1.fedfab.com</td>
<td>8055:8055, 9446:9444</td>
</tr>
<tr>
<td>peer0.org2.fedfab.com</td>
<td>9051:7051, 9447:9444</td>
</tr>
</tbody></table>
<ul>
<li>验证是否加入通道<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer channel getinfo -c channel2</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2022-08-29 09:28:21.265 UTC 0001 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">Blockchain info: &#123;<span class="string">&quot;height&quot;</span>:1,<span class="string">&quot;currentBlockHash&quot;</span>:<span class="string">&quot;xHaVldOzr0XQgw20tyMdri5No9dZuSQMez7jUOew/TU=&quot;</span>&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="配置锚节点"><a href="#配置锚节点" class="headerlink" title="配置锚节点"></a>配置锚节点</h4><ul>
<li>获取通道配置<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">peer channel fetch config channel-artifacts/config_block.pb -o orderer.fedfab.com:7050 -c channel2 --tls --cafile <span class="variable">$&#123;PWD&#125;</span>/crypto/ordererOrganizations/fedfab.com/orderers/orderer.fedfab.com/msp/tlscacerts/tlsca.fedfab.com-cert.pem</span><br><span class="line"><span class="built_in">cd</span> channel-artifacts</span><br></pre></td></tr></table></figure></li>
<li>pb文件转为json文件<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">configtxlator proto_decode --input config_block.pb --<span class="built_in">type</span> common.Block --output config_block.json</span><br><span class="line">jq .data.data[0].payload.data.config config_block.json &gt; config.json</span><br><span class="line"><span class="built_in">cp</span> config.json config_copy.json</span><br></pre></td></tr></table></figure></li>
<li>使用jq工具将Org1的Peer锚节点添加到通道配置中</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jq <span class="string">&#x27;.channel_group.groups.Application.groups.Org2MSP.values += &#123;&quot;AnchorPeers&quot;:&#123;&quot;mod_policy&quot;: &quot;Admins&quot;,&quot;value&quot;:&#123;&quot;anchor_peers&quot;: [&#123;&quot;host&quot;: &quot;peer0.org2.fedfab.com&quot;,&quot;port&quot;: 9051&#125;]&#125;,&quot;version&quot;: &quot;0&quot;&#125;&#125;&#x27;</span> config_copy.json &gt; modified_config.json</span><br></pre></td></tr></table></figure>
<ul>
<li><p>完成此步骤后，我们在modified_config.json文件中以JSON格式获取了通道配置的更新版本。现在，我们可以将原始和修改的通道配置都转换回protobuf格式，并计算它们之间的差异。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">configtxlator proto_encode --input config.json --<span class="built_in">type</span> common.Config --output config.pb</span><br><span class="line">configtxlator proto_encode --input modified_config.json --<span class="built_in">type</span> common.Config --output modified_config.pb</span><br><span class="line">configtxlator compute_update --channel_id channel2 --original config.pb --updated modified_config.pb --output config_update.pb</span><br></pre></td></tr></table></figure></li>
<li><p>名为channel_update.pb的新的protobuf包含我们需要应用于通道配置的Peer锚节点更新。我们可以将配置更新包装在交易Envelope中，以创建通道配置更新交易。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">configtxlator proto_decode --input config_update.pb --<span class="built_in">type</span> common.ConfigUpdate --output config_update.json</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#123;&quot;payload&quot;:&#123;&quot;header&quot;:&#123;&quot;channel_header&quot;:&#123;&quot;channel_id&quot;:&quot;channel2&quot;, &quot;type&quot;:2&#125;&#125;,&quot;data&quot;:&#123;&quot;config_update&quot;:&#x27;</span>$(<span class="built_in">cat</span> config_update.json)<span class="string">&#x27;&#125;&#125;&#125;&#x27;</span> | jq . &gt; config_update_in_envelope.json</span><br><span class="line">configtxlator proto_encode --input config_update_in_envelope.json --<span class="built_in">type</span> common.Envelope --output config_update_in_envelope.pb</span><br></pre></td></tr></table></figure></li>
<li><p>我们可以通过向peer channel update命令提供新的通道配置来添加Peer锚节点。因为我们正在更新仅影响Org1的部分通道配置，所以其他通道成员不需要批准通道更新。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">peer channel update -f channel-artifacts/config_update_in_envelope.pb -c channel2 -o orderer.fedfab.com:7050 --tls --cafile <span class="variable">$&#123;PWD&#125;</span>/crypto/ordererOrganizations/fedfab.com/orderers/orderer.fedfab.com/msp/tlscacerts/tlsca.fedfab.com-cert.pem</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2022-08-29 09:47:17.178 UTC 0001 INFO [channelCmd] InitCmdFactory -&gt; Endorser and orderer connections initialized</span><br><span class="line">2022-08-29 09:47:17.185 UTC 0002 INFO [channelCmd] update -&gt; Successfully submitted channel update</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入org2的cli，执行上面的类似操作</p>
</li>
<li><p>验证已经更新</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer channel getinfo -c channel2</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Blockchain info: &#123;<span class="string">&quot;height&quot;</span>:3,<span class="string">&quot;currentBlockHash&quot;</span>:<span class="string">&quot;ScjYWX32DW8yvtDZ+DnLOljrFnHIjlCT2WbM2s19lF0=&quot;</span>,<span class="string">&quot;previousBlockHash&quot;</span>:<span class="string">&quot;hTNOb9vIRm2sm8XPgrEsz33w/Ivc28MINV4Kn6ICXyU=&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<p>已经有三个块了</p>
</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>fabric-2.fabric自定义与实践</p><p><a href="https://jingtianer.github.io/home/2022/10/22/fedfab/fabric/2.fabric自定义与实践/">https://jingtianer.github.io/home/2022/10/22/fedfab/fabric/2.fabric自定义与实践/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Meow Meow Liu</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-10-22</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-04-15</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/home/tags/fedfab/">fedfab</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/home/2022/10/22/fedfab/fabric/3.%E9%93%BE%E7%A0%81%E8%BF%90%E8%A1%8C%E4%B8%8EApi%E8%B0%83%E7%94%A8/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">fabric-3.链码运行与Api调用</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/home/2022/10/22/fedfab/fabric/1.fabric%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%90%AD%E5%BB%BA/"><span class="level-item">fabric-1.fabric环境配置与搭建</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "bf011104213f116c71b935b1a6268316",
            repo: "blog_comment",
            owner: "jingtianer",
            clientID: "f0b13fe8021fcd2efe50",
            clientSecret: "35207c14b34e77c48a3aeee1e94c9da169ffe0c2",
            admin: ["jingtianer"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#主要工作"><span class="level-left"><span class="level-item">1</span><span class="level-item">主要工作</span></span></a></li><li><a class="level is-mobile" href="#fabric环境变量"><span class="level-left"><span class="level-item">2</span><span class="level-item">fabric环境变量</span></span></a></li><li><a class="level is-mobile" href="#创建节点目录，使用cryptogen命令"><span class="level-left"><span class="level-item">3</span><span class="level-item">创建节点目录，使用cryptogen命令</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#创建模板文件"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">创建模板文件</span></span></a></li><li><a class="level is-mobile" href="#修改模板"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">修改模板</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#排序节点"><span class="level-left"><span class="level-item">3.2.1</span><span class="level-item">排序节点</span></span></a></li><li><a class="level is-mobile" href="#peer节点（组织1）"><span class="level-left"><span class="level-item">3.2.2</span><span class="level-item">peer节点（组织1）</span></span></a></li><li><a class="level is-mobile" href="#peer节点（组织2）"><span class="level-left"><span class="level-item">3.2.3</span><span class="level-item">peer节点（组织2）</span></span></a></li></ul></li><li><a class="level is-mobile" href="#生成证书文件"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">生成证书文件</span></span></a></li></ul></li><li><a class="level is-mobile" href="#创建通道"><span class="level-left"><span class="level-item">4</span><span class="level-item">创建通道</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#configtxgen的使用"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">configtxgen的使用</span></span></a></li><li><a class="level is-mobile" href="#configtx-yaml的编写"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">configtx.yaml的编写</span></span></a></li><li><a class="level is-mobile" href="#创建configtx文件夹"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">创建configtx文件夹</span></span></a></li><li><a class="level is-mobile" href="#修改配置文件"><span class="level-left"><span class="level-item">4.4</span><span class="level-item">修改配置文件</span></span></a></li><li><a class="level is-mobile" href="#创建环境变量"><span class="level-left"><span class="level-item">4.5</span><span class="level-item">创建环境变量</span></span></a></li><li><a class="level is-mobile" href="#创建创世块"><span class="level-left"><span class="level-item">4.6</span><span class="level-item">创建创世块</span></span></a></li><li><a class="level is-mobile" href="#创建应用通道"><span class="level-left"><span class="level-item">4.7</span><span class="level-item">创建应用通道</span></span></a></li></ul></li><li><a class="level is-mobile" href="#创建peer节点和order节点"><span class="level-left"><span class="level-item">5</span><span class="level-item">创建peer节点和order节点</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#修改order节点"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">修改order节点</span></span></a></li><li><a class="level is-mobile" href="#增加节点个数"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">增加节点个数</span></span></a></li><li><a class="level is-mobile" href="#修改容器的文件夹映射"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">修改容器的文件夹映射</span></span></a></li><li><a class="level is-mobile" href="#修改端口号"><span class="level-left"><span class="level-item">5.4</span><span class="level-item">修改端口号</span></span></a></li><li><a class="level is-mobile" href="#CLI（命令行接口）配置"><span class="level-left"><span class="level-item">5.5</span><span class="level-item">CLI（命令行接口）配置</span></span></a></li><li><a class="level is-mobile" href="#运行"><span class="level-left"><span class="level-item">5.6</span><span class="level-item">运行</span></span></a></li><li><a class="level is-mobile" href="#验证容器是否启动"><span class="level-left"><span class="level-item">5.7</span><span class="level-item">验证容器是否启动</span></span></a></li></ul></li><li><a class="level is-mobile" href="#补充"><span class="level-left"><span class="level-item">6</span><span class="level-item">补充</span></span></a></li><li><a class="level is-mobile" href="#修改host文件"><span class="level-left"><span class="level-item">7</span><span class="level-item">修改host文件</span></span></a></li><li><a class="level is-mobile" href="#安装链码"><span class="level-left"><span class="level-item">8</span><span class="level-item">安装链码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Housekeeping"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">Housekeeping</span></span></a></li><li><a class="level is-mobile" href="#编写链码，编译"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">编写链码，编译</span></span></a></li><li><a class="level is-mobile" href="#配置通道"><span class="level-left"><span class="level-item">8.3</span><span class="level-item">配置通道</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#进入cli容器"><span class="level-left"><span class="level-item">8.3.1</span><span class="level-item">进入cli容器</span></span></a></li><li><a class="level is-mobile" href="#安装通道"><span class="level-left"><span class="level-item">8.3.2</span><span class="level-item">安装通道</span></span></a></li><li><a class="level is-mobile" href="#将生成的channel2-block复制到其他cli中"><span class="level-left"><span class="level-item">8.3.3</span><span class="level-item">将生成的channel2.block复制到其他cli中</span></span></a></li><li><a class="level is-mobile" href="#加入channel"><span class="level-left"><span class="level-item">8.3.4</span><span class="level-item">加入channel</span></span></a></li><li><a class="level is-mobile" href="#配置锚节点"><span class="level-left"><span class="level-item">8.3.5</span><span class="level-item">配置锚节点</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/home/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/home/">Meow!!</a><p class="is-size-7"><span>&copy; 2025 Meow Meow Liu</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/home/js/column.js"></script><script src="/home/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/home/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/home/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/home/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/home/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="/home/js/fairyDustCursor.js"></script><link rel="stylesheet" type="text/css" href="/home/css/textPopup.css"><script type="text/javascript" src="/home/js/textPopup.js"></script><script type="text/javascript" src="/home/js/clickClipBoard.js"></script><script type="module" src="/home/js/mermaidInitializer.js"></script><script src="/home/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/home/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":true}});</script></body></html>